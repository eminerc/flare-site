<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Flare</title>
    <meta name="description" content="Flare: Diffusion-based computational photography software">
    <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
    <header class="header">
        <a href="/" class="header-logo">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512">
                <defs>
                    <mask id="circle-mask">
                        <circle cx="256" cy="256" r="256" fill="white"/>
                    </mask>
                </defs>
                <g mask="url(#circle-mask)">
                    <path fill="#ff4500" d="M236,513C157.352,513,79.205,513,1.029,513C1.029,342.394,1.029,171.788,1.029,1.091C171.564,1.091,342.129,1.091,512.846,1.091C512.846,171.667,512.846,342.333,512.846,513C420.788,513,328.644,513,236,513M186.5,377.957C249.622,377.645,312.744,377.331,375.865,377.022C381.03,376.997,386.207,376.769,391.357,377.043C412.701,378.179,427.183,359.848,427.069,341.088C426.794,295.94,427.012,250.788,426.933,205.638C426.926,201.335,426.534,196.98,425.792,192.741C423.419,179.192,408.331,165.527,395.158,165.066C380.69,164.559,366.196,163.798,351.746,164.238C343.756,164.481,339.47,160.998,335.87,154.76C329.795,144.233,323.501,133.831,317.14,123.473C314.652,119.421,310.88,117.047,305.971,117.043C273.65,117.022,241.328,116.993,209.007,117.083C203.698,117.098,199.389,119.413,196.573,124.135C194.441,127.711,192.264,131.259,190.07,134.797C185.069,142.864,180.049,150.918,175.03,158.974C172.685,162.737,169.243,163.989,164.879,164.13C160.937,164.258,159.812,161.976,158.564,159.05C158.164,158.112,156.494,157.178,155.39,157.16C145.61,156.995,135.824,156.92,126.047,157.149C124.64,157.182,122.309,158.782,122.065,159.992C121.198,164.29,118.282,165.209,114.681,166.136C99.221,170.115,87.17,184.669,87.107,200.255C86.914,248.07,86.886,295.887,87.117,343.702C87.201,361.048,102.78,376.647,119.59,376.967C141.558,377.384,163.53,377.635,186.5,377.957z"/>
                    <path fill="#FA7716" d="M245.972,368.932C240.086,368.024,234.004,367.775,228.344,366.1C194.057,355.956,171.237,333.316,160.421,299.651C147.147,258.335,160.254,214.488,197.417,186.72C216.391,172.543,237.689,166.783,261.401,167.853C295.674,169.4,322.761,184.476,341.534,212.221C377.044,264.701,355.536,336.756,296.862,361.92C289.389,365.125,280.965,366.111,272.292,368.311C271.375,368.591,271.148,368.686,270.92,368.78C270.486,368.757,270.051,368.733,268.847,368.787C260.709,368.887,253.341,368.91,245.972,368.932M313.745,290.201C311.317,284.219,308.656,278.317,306.531,272.229C304.702,266.988,302.966,261.613,302.134,256.154C301.228,250.209,297.709,247.511,293.261,251.383C288.14,255.841,284.26,261.752,280.004,267.16C278.875,268.595,278.344,270.5,277.538,272.19C277.074,272.1,276.611,272.01,276.147,271.92C276.022,270.253,275.596,268.543,275.821,266.924C277.259,256.584,279.306,246.307,280.279,235.927C282.281,214.579,266.576,190.478,246.359,183.362C244.523,182.716,241.323,182.62,240.345,183.703C239.128,185.05,239.217,187.912,239.358,190.08C239.611,193.993,241.374,198.093,240.627,201.729C238.911,210.085,237.452,218.994,233.352,226.244C227.268,237.004,219.084,246.594,211.622,256.553C200.104,271.924,195.727,289.428,199.267,307.898C206.99,348.181,252.839,364.791,284.553,346.586C305.643,334.48,316.276,315.998,313.745,290.201z"/>
                </g>
            </svg>
        </a>
        <nav class="header-nav">
            <a href="/" class="nav-link">Home</a>
            <a href="pages/showcase.html" class="nav-link" target="_blank" rel="noopener">Showcase</a>
            <a href="pages/contact.html" class="nav-link">Contact</a>
        </nav>
    </header>

    <main>
        <section class="section hero">
            <div class="hero-content">
                <h1 class="title">FLARE</h1>
                <p class="tagline">take professional quality shots on mobile<br>with a diffusion-based photography stack</p>
                <button class="demo-button" onclick="window.open('pages/showcase.html', '_blank')">VIEW GALLERY</button>
            </div>
        </section>

        <section class="section product-section">
            <p class="product-tagline">
                FLARE makes every photo you capture on mobile look high quality and professionally shot using context-aware diffusion-models that enrich them in ways otherwise impossible with traditional camera modules.
            </p>
        </section>

                <!-- DEMO BACKGROUNDS -->
        <div id="demo-bg-lowlight" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0; pointer-events: none;">
            <div style="position: absolute; left: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/lowlight_before.jpg'); background-size: cover; background-position: center;"></div>
            <div style="position: absolute; right: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/lowlight_after.png'); background-size: cover; background-position: center;"></div>
        </div>
        
        <div id="demo-bg-zoom" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0; pointer-events: none;">
            <div style="position: absolute; left: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/zoom_before.png'); background-size: cover; background-position: center;"></div>
            <div style="position: absolute; right: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/zoom_after.png'); background-size: cover; background-position: center;"></div>
        </div>
        
        <div id="demo-bg-subject" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0; pointer-events: none;">
            <div style="position: absolute; left: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/busyimg_before.jpg'); background-size: cover; background-position: center;"></div>
            <div style="position: absolute; right: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/busyimg_after.png'); background-size: cover; background-position: center;"></div>
        </div>
        
        <div id="demo-bg-lighting" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0; pointer-events: none;">
            <div style="position: absolute; left: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/shittycam_before.jpeg'); background-size: cover; background-position: center;"></div>
            <div style="position: absolute; right: 0; top: 0; width: 50%; height: 100%; background-image: url('assets/images/demo/shittycam_after.png'); background-size: cover; background-position: center;"></div>
        </div>

            <!-- Scrolling Demo Text Sections -->
            <section class="demo-section" data-demo="lowlight">
                <div class="demo-text-overlay">
                    <h2 class="demo-title">Ultra-Low Light</h2>
                    <p class="demo-description">Transform dark, noisy photos into bright, clear images without losing detail or adding noise.</p>
                            </div>
            </section>

            <section class="demo-section" data-demo="zoom">
                <div class="demo-text-overlay">
                    <h2 class="demo-title">50x+ Zoom</h2>
                    <p class="demo-description">Achieve incredible zoom clarity beyond your phone's optical limits using AI-powered super-resolution.</p>
                            </div>
            </section>

            <section class="demo-section" data-demo="subject">
                <div class="demo-text-overlay">
                    <h2 class="demo-title">Subject Isolation</h2>
                    <p class="demo-description">Automatically identify and enhance subjects while artistically blurring busy backgrounds.</p>
                </div>
            </section>

            <section class="demo-section" data-demo="lighting">
                <div class="demo-text-overlay">
                    <h2 class="demo-title">Improved Lighting and Composition</h2>
                    <p class="demo-description">Turn low-quality smartphone photos into professional-looking shots with enhanced detail and color.</p>
                </div>
            </section>
            
 
        <section class="section strategies">
            <div class="strategy-container">
                <div class="strategy-box">
                    <h3>The Flare Cloud ISP</h3>
                    <div class="isp-comparison">
                        <div class="comparison-table">
                            <table>
                                <tr>
                                    <td></td>
                                    <td>Delivers flagship-quality on low-cost sensors</td>
                                    <td>Fully corrects poor capture conditions</td>
                                    <td>Improves over device lifetime</td>
                                </tr>
                                <tr class="traditional-row">
                                    <td class="row-label">Traditional ISP</td>
                                    <td>✗</td>
                                    <td>✗</td>
                                    <td>✗</td>
                                </tr>
                                <tr class="flare-row">
                                    <td class="row-label">FLARE</td>
                                    <td>✓</td>
                                    <td>✓</td>
                                    <td>✓</td>
                                </tr>
                            </table>
                        </div>
                        <div class="comparison-explanation">
                            <p>Traditional ISP chips are fixed-function hardware with limited capabilities, while FLARE provides a cloud-powered ISP with AI enhancement that transforms mobile photography.</p>
                        </div>
                    </div>
                    <a href="pages/contact.html" class="action-button reach-out-button">Reach Out</a>
                </div>
                
                <div class="strategy-box">
                    <h3>Flare Camera and Gallery App</h3>
                    <div class="phone-mockup"></div>
                    <a href="pages/showcase.html" class="action-button showcase-button" target="_blank" rel="noopener">App Showcase</a>
                </div>
            </div>
        </section>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512">
                            <defs>
                                <mask id="footer-circle-mask">
                                    <circle cx="256" cy="256" r="256" fill="white"/>
                                </mask>
                            </defs>
                            <g mask="url(#footer-circle-mask)">
                                <path fill="#ff4500" d="M236,513C157.352,513,79.205,513,1.029,513C1.029,342.394,1.029,171.788,1.029,1.091C171.564,1.091,342.129,1.091,512.846,1.091C512.846,171.667,512.846,342.333,512.846,513C420.788,513,328.644,513,236,513M186.5,377.957C249.622,377.645,312.744,377.331,375.865,377.022C381.03,376.997,386.207,376.769,391.357,377.043C412.701,378.179,427.183,359.848,427.069,341.088C426.794,295.94,427.012,250.788,426.933,205.638C426.926,201.335,426.534,196.98,425.792,192.741C423.419,179.192,408.331,165.527,395.158,165.066C380.69,164.559,366.196,163.798,351.746,164.238C343.756,164.481,339.47,160.998,335.87,154.76C329.795,144.233,323.501,133.831,317.14,123.473C314.652,119.421,310.88,117.047,305.971,117.043C273.65,117.022,241.328,116.993,209.007,117.083C203.698,117.098,199.389,119.413,196.573,124.135C194.441,127.711,192.264,131.259,190.07,134.797C185.069,142.864,180.049,150.918,175.03,158.974C172.685,162.737,169.243,163.989,164.879,164.13C160.937,164.258,159.812,161.976,158.564,159.05C158.164,158.112,156.494,157.178,155.39,157.16C145.61,156.995,135.824,156.92,126.047,157.149C124.64,157.182,122.309,158.782,122.065,159.992C121.198,164.29,118.282,165.209,114.681,166.136C99.221,170.115,87.17,184.669,87.107,200.255C86.914,248.07,86.886,295.887,87.117,343.702C87.201,361.048,102.78,376.647,119.59,376.967C141.558,377.384,163.53,377.635,186.5,377.957z"/>
                                <path fill="#FA7716" d="M245.972,368.932C240.086,368.024,234.004,367.775,228.344,366.1C194.057,355.956,171.237,333.316,160.421,299.651C147.147,258.335,160.254,214.488,197.417,186.72C216.391,172.543,237.689,166.783,261.401,167.853C295.674,169.4,322.761,184.476,341.534,212.221C377.044,264.701,355.536,336.756,296.862,361.92C289.389,365.125,280.965,366.111,272.292,368.311C271.375,368.591,271.148,368.686,270.92,368.78C270.486,368.757,270.051,368.733,268.847,368.787C260.709,368.887,253.341,368.91,245.972,368.932M313.745,290.201C311.317,284.219,308.656,278.317,306.531,272.229C304.702,266.988,302.966,261.613,302.134,256.154C301.228,250.209,297.709,247.511,293.261,251.383C288.14,255.841,284.26,261.752,280.004,267.16C278.875,268.595,278.344,270.5,277.538,272.19C277.074,272.1,276.611,272.01,276.147,271.92C276.022,270.253,275.596,268.543,275.821,266.924C277.259,256.584,279.306,246.307,280.279,235.927C282.281,214.579,266.576,190.478,246.359,183.362C244.523,182.716,241.323,182.62,240.345,183.703C239.128,185.05,239.217,187.912,239.358,190.08C239.611,193.993,241.374,198.093,240.627,201.729C238.911,210.085,237.452,218.994,233.352,226.244C227.268,237.004,219.084,246.594,211.622,256.553C200.104,271.924,195.727,289.428,199.267,307.898C206.99,348.181,252.839,364.791,284.553,346.586C305.643,334.48,316.276,315.998,313.745,290.201z"/>
                            </g>
                        </svg>
                        <span class="footer-brand">FLARE</span>
                    </div>
                    <p class="footer-tagline">Professional mobile photography through AI</p>
                </div>

                <div class="footer-section">
                    <h4 class="footer-title">Product</h4>
                    <nav class="footer-nav">
                        <a href="pages/showcase.html" class="footer-link" target="_blank" rel="noopener">App Showcase</a>
                    </nav>
                </div>
            </div>

            <div class="footer-bottom">
                <p class="copyright">&copy; 2025 FLARE. All rights reserved.</p>
                <div class="footer-bottom-links">

                </div>
            </div>
        </footer>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Handle header visibility
            const header = document.querySelector('.header');
            const scrollContainer = document.querySelector('main');
            
            // Demo background switching - FIXED VERSION
            const demoSections = document.querySelectorAll('.demo-section');
            const demoBackgrounds = document.querySelectorAll('.demo-bg');
            let currentActiveSection = -1;
            let lastScrollY = window.scrollY;
            let scrollDirection = 'down';

            function updateDemoDisplay() {
                const demoNames = ['lowlight', 'zoom', 'subject', 'lighting'];

                let bestIndex = -1;
                let minDistanceFromCenter = Infinity;
                const viewportHeight = window.innerHeight;
                const viewportCenter = viewportHeight / 2;
                // Directional bands: later when scrolling down, earlier when scrolling up
                const downBandTop = viewportHeight * 0.58;
                const downBandBottom = viewportHeight * 0.82;
                const upBandTop = viewportHeight * 0.18;
                const upBandBottom = viewportHeight * 0.42;

                for (let i = 0; i < demoSections.length; i++) {
                    const section = demoSections[i];
                    const rect = section.getBoundingClientRect();

                    // skip if not visible at all
                    if (rect.bottom <= 0 || rect.top >= window.innerHeight) continue;

                    const sectionCenter = rect.top + rect.height / 2;
                    const distance = Math.abs(sectionCenter - viewportCenter);

                    if (distance < minDistanceFromCenter) {
                        minDistanceFromCenter = distance;
                        bestIndex = i;
                    }
                }

                const demoIds = ['demo-bg-lowlight', 'demo-bg-zoom', 'demo-bg-subject', 'demo-bg-lighting'];
                const lastIndex = demoIds.length - 1;

                // Early hide: if current active section has just left the viewport (a bit before 0), clear active
                // For the LAST demo, hide instantly (no fade) to avoid covering content
                const earlyHidePx = Math.round(window.innerHeight * 0.22); // hide sooner (~22% of viewport)
                if (currentActiveSection !== -1) {
                    const curRect = demoSections[currentActiveSection].getBoundingClientRect();
                    const viewportH = window.innerHeight;
                    const scrolledPastTop = curRect.bottom <= earlyHidePx; // scrolling down
                    const scrolledPastBottom = curRect.top >= (viewportH - earlyHidePx); // scrolling up
                    if (scrolledPastTop || scrolledPastBottom) {
                        // If last demo was active, disable transition for instant hide
                        if (currentActiveSection === lastIndex) {
                            const lastBg = document.getElementById(demoIds[lastIndex]);
                            if (lastBg) {
                                lastBg.style.transition = 'none';
                                lastBg.style.opacity = '0';
                            }
                        }
                        currentActiveSection = -1;
                        // Also ensure all are hidden
                        for (let i = 0; i < demoIds.length; i++) {
                            const bg = document.getElementById(demoIds[i]);
                            if (bg) {
                                bg.classList.remove('is-visible');
                                bg.style.opacity = '0';
                            }
                        }
                        return; // keep everything hidden
                    }
                }

                // hide all backgrounds
                for (let i = 0; i < demoIds.length; i++) {
                    const bg = document.getElementById(demoIds[i]);
                    if (bg) {
                        bg.classList.remove('is-visible');
                        bg.style.opacity = '0';
                    }
                }

                // show the best match, but only switch when the section center enters the directional band
                if (bestIndex !== -1) {
                    const bestRect = demoSections[bestIndex].getBoundingClientRect();
                    const bestCenter = bestRect.top + bestRect.height / 2;
                    const isInBand = scrollDirection === 'down'
                        ? (bestCenter >= downBandTop && bestCenter <= downBandBottom)
                        : (bestCenter >= upBandTop && bestCenter <= upBandBottom);

                    if (isInBand) {
                        const activeId = demoIds[bestIndex];
                        const activeBg = document.getElementById(activeId);
                        if (activeBg) {
                            // Mark as visible: remove blur and show instantly
                            activeBg.classList.add('is-visible');
                            activeBg.style.opacity = '1';
                        }
                        currentActiveSection = bestIndex;
                    } else if (currentActiveSection !== -1) {
                        // Keep current active background until the new one is firmly in the band
                        const keepId = demoIds[currentActiveSection];
                        const keepBg = document.getElementById(keepId);
                        if (keepBg) {
                            keepBg.classList.add('is-visible');
                            keepBg.style.opacity = '1';
                        }
                    }
                } else {
                    // No demo sections are visible; ensure nothing stays active
                    if (currentActiveSection === lastIndex) {
                        const lastBg = document.getElementById(demoIds[lastIndex]);
                        if (lastBg) {
                            lastBg.style.transition = 'none';
                            lastBg.style.opacity = '0';
                        }
                    }
                    currentActiveSection = -1;
                }
            }
        
        // Throttled scroll handler for better performance
        let ticking = false;
        const onScroll = () => {
            if (!ticking) {
                requestAnimationFrame(() => {
                        // Header backdrop filter handling
                    const shouldRemove = window.scrollY > 0;
                    header.style.backdropFilter = shouldRemove ? 'none' : 'blur(12px) saturate(150%)';
                    header.style.webkitBackdropFilter = shouldRemove ? 'none' : 'blur(12px) saturate(150%)';

                        // Determine direction
                        const curY = window.scrollY;
                        if (curY > lastScrollY) scrollDirection = 'down';
                        else if (curY < lastScrollY) scrollDirection = 'up';
                        lastScrollY = curY;

                        // Update demo display
                        updateDemoDisplay();
                        // Update header visibility over demos
                        updateHeaderVisibility();
                        
                    ticking = false;
                });
                ticking = true;
            }
        };
        window.addEventListener('scroll', onScroll, { passive: true });
        if (scrollContainer) scrollContainer.addEventListener('scroll', onScroll, { passive: true });

            // Handle resize
            window.addEventListener('resize', () => {
                updateDemoDisplay();
            });

            // Initialize
            console.log(`Demo system initialized with ${demoSections.length} sections and ${demoBackgrounds.length} backgrounds`);
            demoSections.forEach((section, i) => {
                console.log(`Section ${i}:`, section.dataset.demo);
            });
            demoBackgrounds.forEach((bg, i) => {
                console.log(`Background ${i}:`, bg.dataset.demo);
            });
            
            // Make first demo background present immediately (like entering a page)
            const firstBgInit = document.getElementById('demo-bg-lowlight');
            if (firstBgInit) {
                firstBgInit.classList.add('is-visible');
                firstBgInit.style.opacity = '1';
            }
            
            // Hide header when inside any demo section (slide up), show elsewhere
            const updateHeaderVisibility = () => {
                let anyDemoInView = false;
                for (let i = 0; i < demoSections.length; i++) {
                    const rect = demoSections[i].getBoundingClientRect();
                    if (rect.bottom > 0 && rect.top < window.innerHeight) {
                        anyDemoInView = true;
                        break;
                    }
                }
                if (anyDemoInView) {
                    header.classList.add('hidden');
                } else {
                    header.classList.remove('hidden');
                }
            };
            
            // Initial call
            updateDemoDisplay();
            updateHeaderVisibility();
        });

        // Fix mobile viewport height issues
        function setVH() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        // Set initial value
        setVH();

        // Update on resize and orientation change
        window.addEventListener('resize', setVH);
        window.addEventListener('orientationchange', () => {
            setTimeout(setVH, 100); // Small delay for orientation change
        });
    </script>
</body>
</html>